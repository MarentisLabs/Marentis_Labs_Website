<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Owen Vallis">
<meta name="description" content="A C-Suite Framework for Geopolitical Risk Strategy">

<title>Navigating the Polycrisis: – Marentis Labs Insights</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-768c135172f32a44277a7ca6ed00a94d.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-58ef5de1842441747b442e9c242288ff.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="icon" type="image/png" href="../Marentis Mini Logo.png"> 



<script src="https://cdn.tailwindcss.com"></script>



<script>

  tailwind.config = {

    theme: {

      extend: {

        colors: {

          'ml-charcoal': '#212529',

          'ml-slate-grey': '#495057',

          'ml-gold': '#a98c5a',

          'ml-slate-blue': '#4a6572',

          'ml-light-bg': '#f8f9fa',

        },

        fontFamily: {

          // Ensure 'Inter' matches font-family used in CSS/SCSS

          sans: ['Inter', 'sans-serif'], 

        }

      }

    }

  }

</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="fullcontent quarto-light">

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">
<header class="site-header" style="background-color: #ffffff; position: sticky; /* Changed from fixed */ top: 0; left: 0; right: 0; z-index: 1000;">

  <nav style="max-width: 1400px; margin: 0 auto; padding: 1rem 2rem; display: flex; align-items: center; justify-content: space-between;">

    <a href="../" style="display: flex; align-items: center; text-decoration: none;">

      <img src="../Marentis Labs NoTag Logo.png" alt="Marentis Labs" style="height: 40px; width: auto;">

    </a>

    

    <div style="display: flex; gap: 2rem; align-items: center;">

      <a href="../" style="color: #212529; text-decoration: none; font-family: 'Inter', sans-serif; font-size: 0.95rem; font-weight: 500; transition: color 0.2s ease;" onmouseover="this.style.color='#a98c5a'" onmouseout="this.style.color='#212529'">Home</a>

      <a href="../services.html" style="color: #212529; text-decoration: none; font-family: 'Inter', sans-serif; font-size: 0.95rem; font-weight: 500; transition: color 0.2s ease;" onmouseover="this.style.color='#a98c5a'" onmouseout="this.style.color='#212529'">Services</a>

      <a href="../insights/insights.html" style="color: #a98c5a; text-decoration: none; font-family: 'Inter', sans-serif; font-size: 0.95rem; font-weight: 700; transition: color 0.2s ease;">Insights</a>

      <a href="../about.html" style="color: #212529; text-decoration: none; font-family: 'Inter', sans-serif; font-size: 0.95rem; font-weight: 500; transition: color 0.2s ease;" onmouseover="this.style.color='#a98c5a'" onmouseout="this.style.color='#212529'">About</a>

      <a href="../contact.html" style="color: #ffffff; text-decoration: none; font-family: 'Inter', sans-serif; font-size: 0.95rem; font-weight: 500; padding: 0.5rem 1.25rem; background-color: #a98c5a; border-radius: 4px; transition: all 0.2s ease;" onmouseover="this.style.backgroundColor='#92754c'; this.style.color='#ffffff'" onmouseout="this.style.backgroundColor='#a98c5a'; this.style.color='#ffffff'">Contact</a>

    </div>

    </nav>

</header>
<div class="watermark" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 60vw; max-width: 1200px; /* Adjusted max-width */ opacity: 0.15; /* Adjusted opacity */ z-index: 0; pointer-events: none;">

  <img src="../Marentis Mini LogoBackground.png" alt="" style="width: 100%; height: auto; display: block;">

</div>

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Navigating the Polycrisis:</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Risk Management</div>
    <div class="quarto-category">Portfolio Strategy</div>
  </div>
  </div>

<div>
  <div class="description">
    A C-Suite Framework for Geopolitical Risk Strategy
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Owen Vallis </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="article-metadata">
<div class="article-title">
<p>Navigating the Polycrisis:</p>
</div>
<div class="article-description">
<p>A C-Suite Framework for Geopolitical Risk Strategy</p>
</div>
<div class="article-meta-info">
<div class="meta-item">
<p><strong>Date:</strong> August 2025</p>
</div>
<div class="meta-item">
<p><strong>Author:</strong> Owen Vallis</p>
</div>
</div>
</div>
<section id="i.-introduction-the-end-of-the-stable-world" class="level3">
<h3 class="anchored" data-anchor-id="i.-introduction-the-end-of-the-stable-world"><strong>I. Introduction: The End of the Stable World</strong></h3>
<p>The era of predictable globalization is over. For decades, the C-suite could build strategies on a foundation of relatively stable international trade, open markets, and consistent regulatory frameworks. That foundation is now fractured. From trade wars and supply chain disruptions to regional conflicts and rising nationalism, geopolitical volatility is no longer a rare, black-swan event; it is a permanent feature of the business landscape. We have entered a “polycrisis”—a cascade of interconnected risks where a shock in one domain rapidly triggers instability in others.</p>
<p>For senior leaders, this new reality presents a profound challenge. Globally, executives now rank political and geopolitical disruption as a primary concern, a factor that is particularly hard to manage and requires their direct attention. Yet, in many organizations, the approach to managing this risk remains dangerously outdated. Geopolitics is often treated as a peripheral issue, delegated to a government affairs or public relations team, rather than being recognized as a core input for C-suite strategy. This executive blind spot leaves companies dangerously exposed, vulnerable to shocks that can erase billions in value overnight.</p>
<p>The imperative for leaders is to move beyond reactive crisis management. Thriving in this new era requires a fundamental shift in strategic thinking—from viewing geopolitical risk as an unpredictable threat to be weathered, to treating it as a dynamic variable to be actively managed. This article provides a practical framework for senior leaders to embed geopolitical risk analysis into their core strategic planning process, transforming it from a source of vulnerability into a potential source of durable competitive advantage.</p>
</section>
<section id="ii.-the-modern-risk-map-four-dimensions-of-geopolitical-impact" class="level3">
<h3 class="anchored" data-anchor-id="ii.-the-modern-risk-map-four-dimensions-of-geopolitical-impact"><strong>II. The Modern Risk Map: Four Dimensions of Geopolitical Impact</strong></h3>
<p>To effectively manage geopolitical risk, leaders must first understand its multifaceted nature. Moving beyond vague notions of “instability,” a structured approach involves mapping potential impacts across four critical dimensions of the business.</p>
<ul>
<li><p><strong>1. Market Access Risk:</strong> The most direct threat comes from the potential for markets to close or become prohibitively expensive. This includes the imposition of tariffs, sanctions, or outright trade embargos that can sever access to key customer bases or growth regions. Beyond formal barriers, companies face the softer but equally potent risk of shifting consumer sentiment. In a polarized world, a brand’s perceived national alignment or its stance on a sensitive issue can rapidly alienate a significant portion of its market, impacting sales and brand loyalty.</p></li>
<li><p><strong>2. Supply Chain &amp; Operational Risk:</strong> The pandemic-era disruptions laid bare the fragility of global supply chains, and geopolitical tensions have only amplified this vulnerability. A conflict or political shift in one region can halt the production of a critical component, stranding inventory and crippling manufacturing worldwide. Leaders must meticulously map their dependencies, not just on primary suppliers but on second- and third-tier providers of raw materials, manufacturing capacity, and even specialized talent. A concentration of critical operations in any single politically sensitive region represents a significant, and often unpriced, risk.</p></li>
<li><p><strong>3. Regulatory &amp; Compliance Risk:</strong> As geopolitical blocs diverge, so do their regulatory philosophies. We are witnessing the rise of divergent and often conflicting regulatory regimes, particularly in areas like data privacy, environmental standards, and technology governance. For a multinational corporation, this creates a complex and costly compliance labyrinth. A product designed for one market may be illegal in another, and data flows that were once seamless now require complex legal and technical workarounds. Navigating this fractured landscape demands constant vigilance and strategic foresight to avoid fines and operational paralysis.</p></li>
<li><p><strong>4. Financial &amp; Currency Risk:</strong> Political instability is a direct driver of financial volatility. A sudden political crisis can trigger dramatic currency devaluations, eroding the value of international revenues and assets. Furthermore, leaders must consider the risk of capital controls, where a government might suddenly restrict the ability to move funds out of a country, trapping profits and investments. The security of both financial and physical assets in politically unstable regions can no longer be taken for granted and must be factored into global capital allocation strategies.</p></li>
</ul>
</section>
<section id="iii.-from-prediction-to-preparedness-the-scenario-planning-toolkit" class="level3">
<h3 class="anchored" data-anchor-id="iii.-from-prediction-to-preparedness-the-scenario-planning-toolkit"><strong>III. From Prediction to Preparedness: The Scenario Planning Toolkit</strong></h3>
<p>In a world of radical uncertainty, attempting to predict the future is a fool’s errand. The goal is not prediction, but preparedness. The most powerful tool for building this preparedness is scenario planning—a disciplined process for envisioning and stress-testing strategy against multiple plausible futures. This approach builds the organizational agility needed to anticipate and adapt. For executives, this process can be simplified into four key steps:</p>
<ul>
<li><p><strong>1. Identify Key Drivers:</strong> The first step is to pinpoint the 2-3 most critical geopolitical uncertainties that could fundamentally alter your business landscape. These are the major, unresolved questions whose outcomes will have the greatest impact. Examples might include the future of US-EU-China trade relations, the outcome of a pivotal national election in a key market, or the potential for escalating conflict in a region vital to your supply chain.</p></li>
<li><p><strong>2. Develop Plausible Scenarios:</strong> For each key driver, create 3-4 distinct, narrative-based future scenarios. These are not forecasts; they are coherent, internally consistent stories about how the world might look in 3-5 years. For example, if the key driver is great-power competition, scenarios could include a “Decoupled World” with two distinct economic and technological blocs, a “Renewed Cooperation” scenario driven by a shared global challenge, or a “Fragmented Blocs” world with multiple competing regional powers.</p></li>
<li><p><strong>3. Stress-Test Your Strategy:</strong> Analyze how your current corporate strategy would perform in each of these imagined futures. Ask the tough questions: If the “Decoupled World” scenario comes to pass, is our supply chain viable? Does our five-year growth plan depend on market access that would no longer exist? This process is designed to identify the breaking points and hidden vulnerabilities in your current strategic assumptions before they are exposed by reality.</p></li>
<li><p><strong>4. Develop “No-Regret” Moves and Hedges:</strong> The final, most critical step is to translate insight into action. Based on the stress test, identify “no-regret” moves—strategic actions that are beneficial across most or all scenarios. Diversifying a supply chain, building regional operational hubs, or investing in cross-cultural leadership development are often robust moves that build resilience regardless of which future unfolds. In addition, define specific hedges for high-impact, lower-probability events—contingency plans that can be activated to mitigate the damage from a specific negative outcome.</p></li>
</ul>
</section>
<section id="iv.-case-study-in-miniature-a-tale-of-two-companies" class="level3">
<h3 class="anchored" data-anchor-id="iv.-case-study-in-miniature-a-tale-of-two-companies"><strong>IV. Case Study in Miniature: A Tale of Two Companies</strong></h3>
<p>Consider two hypothetical firms, both heavily reliant on a single country for a critical manufactured component. A sudden geopolitical dispute triggers an immediate trade embargo on that country.</p>
<p><em>Company A</em>, the reactive firm, is caught completely off guard. Its production lines grind to a halt within weeks. Its leadership team scrambles to find alternative suppliers, but they are forced to pay exorbitant prices for lower-quality components, destroying their margins. The stock price plummets as the market punishes their lack of foresight.</p>
<p><em>Company B</em>, the prepared firm, had identified this dependency as a key risk and used scenario planning to prepare. They had already vetted and established a contractual relationship with a secondary supplier in a different geopolitical region. When the embargo hits, they activate their contingency plan. While there is minor disruption, their production is back to 90% capacity within a month. They communicate proactively with investors, highlighting their operational resilience. As Company A falters, Company B captures its market share, turning a crisis into a competitive victory.</p>
</section>
<section id="v.-conclusion-building-your-geopolitical-shock-absorbers" class="level3">
<h3 class="anchored" data-anchor-id="v.-conclusion-building-your-geopolitical-shock-absorbers"><strong>V. Conclusion: Building Your Geopolitical Shock Absorbers</strong></h3>
<p>In the 21st century, a company’s ability to anticipate and adapt to geopolitical shifts is as critical as its ability to innovate or manage its finances. The frameworks and processes that led to success in a stable, globalized world are no longer sufficient for the volatile and fragmented landscape leaders now face. Building resilience is not about constructing an impenetrable fortress; it is about developing strategic shock absorbers that allow the organization to withstand external blows and even harness their energy for forward momentum.</p>
<p>Integrating geopolitical risk into corporate strategy is a complex but essential discipline. It requires moving beyond headlines and developing a structured, analytical capability within the senior leadership team. By systematically mapping risks, stress-testing strategies through scenario planning, and building a portfolio of no-regret moves, leaders can prepare their organizations not just to survive the polycrisis, but to find opportunities and thrive within it.</p>
<p><em>Marentis Labs provides the frameworks and expertise to help leaders build more resilient organizations prepared to thrive in an uncertain world.</em></p>


</section>

</main> <!-- /main -->
<footer class="site-footer" style="background-color: #ffffff; color: #ffffff; margin-top: 4rem; position: relative; z-index: 10;">

  <div style="max-width: 1400px; margin: 0 auto; padding: 3rem 2rem 2rem 2rem;">

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 3rem; margin-bottom: 2rem;">

      <div>

        <img src="../Marentis Labs NoTag Logo.png" alt="Marentis Labs" style="height: 35px; width: auto; margin-bottom: 1rem;">

        <p style="color: #adb5bd; font-family: 'Inter', sans-serif; font-size: 0.9rem; line-height: 1.6; margin: 0;">

          Strategic Risk &amp; Performance Insights

        </p>

      </div>

      

      <div>

        <h4 style="color: #a98c5a; font-family: 'Inter', sans-serif; font-size: 0.85rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; margin: 0 0 1rem 0;">Quick Links</h4>

        <ul style="list-style: none; padding: 0; margin: 0;">

          <li style="margin-bottom: 0.5rem;"><a href="../services.html" style="color: #adb5bd; text-decoration: none; font-family: 'Inter', sans-serif; font-size: 0.9rem; transition: color 0.2s ease;" onmouseover="this.style.color='#a98c5a'" onmouseout="this.style.color='#adb5bd'">Services</a></li>

          <li style="margin-bottom: 0.5rem;"><a href="../insights/insights.html" style="color: #adb5bd; text-decoration: none; font-family: 'Inter', sans-serif; font-size: 0.9rem; transition: color 0.2s ease;" onmouseover="this.style.color='#a98c5a'" onmouseout="this.style.color='#adb5bd'">Insights</a></li>

          <li style="margin-bottom: 0.5rem;"><a href="../about.html" style="color: #adb5bd; text-decoration: none; font-family: 'Inter', sans-serif; font-size: 0.9rem; transition: color 0.2s ease;" onmouseover="this.style.color='#a98c5a'" onmouseout="this.style.color='#adb5bd'">About</a></li>

          <li style="margin-bottom: 0.5rem;"><a href="../contact.html" style="color: #adb5bd; text-decoration: none; font-family: 'Inter', sans-serif; font-size: 0.9rem; transition: color 0.2s ease;" onmouseover="this.style.color='#a98c5a'" onmouseout="this.style.color='#adb5bd'">Contact</a></li>

        </ul>

      </div>

      

      <div>

        <h4 style="color: #a98c5a; font-family: 'Inter', sans-serif; font-size: 0.85rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; margin: 0 0 1rem 0;">Contact</h4>

        <p style="color: #adb5bd; font-family: 'Inter', sans-serif; font-size: 0.9rem; line-height: 1.6; margin: 0;">

          <a class="email-link" data-user="info" data-domain="marentislabs.com" href="mailto:info@marentislabs.com" style="color: #adb5bd; text-decoration: none; transition: color 0.2s ease;" onmouseover="this.style.color='#a98c5a'" onmouseout="this.style.color='#adb5bd'">info@marentislabs.com</a>

        </p>

      </div>

    </div>

    

    <div style="border-top: 1px solid #495057; padding-top: 2rem; text-align: center;">

      <p style="color: #6c757d; font-family: 'Inter', sans-serif; font-size: 0.85rem; margin: 0;">

        © <span id="current-year"></span> Marentis Labs. All rights reserved. | <a href="../cookies.html" style="color: #6c757d; text-decoration: underline;">Cookies Policy</a>

      </p>

    </div>

  </div>

  <script>

    document.getElementById('current-year').textContent = new Date().getFullYear();

    document.addEventListener('DOMContentLoaded', () => {

      /* Email Obfuscation */ 

      const emailLinks = document.querySelectorAll('.email-link'); 

      emailLinks.forEach(link => { 

        const user = link.dataset.user; 

        const domain = link.dataset.domain; 

        if (user && domain) { 

          const email = user + '@' + domain; 

          link.href = 'mailto:' + email; 

          // Keep placeholder or set text dynamically if preferred

          // link.textContent = email; 

        } 

      });

      

    });

  </script>

  <script>

document.addEventListener('DOMContentLoaded', () => {

    const banner = document.getElementById('cookie-consent-banner');

    const acceptBtn = document.getElementById('cookie-accept-btn');

    const rejectBtn = document.getElementById('cookie-reject-btn');



    // Check if consent has already been given *this session*

    const consent = sessionStorage.getItem('cookieConsent');

    

    if (!consent) {

        // If no consent given, show the banner

        banner.style.display = 'block';

    }



    // Handle "Accept" click

    acceptBtn.addEventListener('click', () => {

        sessionStorage.setItem('cookieConsent', 'accepted');

        banner.style.display = 'none';

        runAnalytics(); // <-- This runs the GA function from the <head>

    });



    // Handle "Reject" click

    rejectBtn.addEventListener('click', () => {

        sessionStorage.setItem('cookieConsent', 'rejected');

        banner.style.display = 'none';

    });

});

</script>

</footer>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/marentislabs\.com\/insights");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>